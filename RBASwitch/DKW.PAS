unit DKW;

interface

uses mirror,dkwinit;

procedure infos;
procedure kreuzung2;
procedure gleisbett2;

implementation

procedure infos;
begin

p:=0;
i:=round(laenge);
while i>25 do
 begin
 i:=i-5;
 p:=p-5;
 end;

{Schreiben des Objektes}

if xoffchk<0 then
assign(f,'temp.txt')
else assign(f,datname);
rewrite(f);

if sprech='d' then
  begin
  writeln(f,';Datei automatisch erstellt von SWITCH - (C) 2002 Ruediger Huelsmann');
  writeln(f);
  writeln(f,';Kreuzungsdaten:');
  writeln(f,';Laenge: ',round(laenge));
  writeln(f,';X-Abweichung: ',xoffchk:3:3);
  write(f,';Abzweigradius: ');
  if radius<>999999 then
    writeln(f,radius:3:3)
    else
    writeln(f,'unendlich (geradeaus)');
  writeln(f,';Winkel: ',winkel:3:3);
  writeln(f,';Richtung: ', richtung2);
  write(f,';Radlenker: ');
  if radlenk='n' then
    writeln(f,'nein')
    else
    writeln(f,'ja');
  write(f,';Oberleitung: ');
  if oberjn='n' then
    writeln(f,'nein')
    else
    writeln(f,'ja');
  if (oberjn<>'n') then
    begin
    writeln(f,';Hoehe Fahrdraht: ',oberfahr:3:3);
    writeln(f,';Hoehe Tragseil: ',obertrag:3:3);
    end;
  writeln(f);
  end

  else

  begin
  writeln(f,';File automatically generated by SWITCH - (C) 2002 Ruediger Huelsmann');
  writeln(f);
  writeln(f,';Crossing data:');
  writeln(f,';Length: ',round(laenge));
  writeln(f,';X-offset: ',xoffchk:3:3);
  write(f,';Turnout radius: ');
  if radius<>999999 then
    writeln(f,radius:3:3)
    else
    writeln(f,'infinite (straight)');
  writeln(f,';Angle: ', winkel:3:3);
  writeln(f,';Direction: ', richtung2);
  write(f,';Guard rails: ');
  if radlenk='n' then
    writeln(f,'no')
    else
    writeln(f,'yes');
  write(f,';Overhead line: ');
  if oberjn='n' then
    writeln(f,'no')
    else
    writeln(f,'yes');
  if (oberjn<>'n') then
    begin
    writeln(f,';Height of contact wire: ',oberfahr:3:3);
    writeln(f,';Height of carrying rope: ',obertrag:3:3);
    end;
  end;
  writeln(f);

end;
procedure kreuzung2;
var i: integer;
begin

{Gleis A, links:}
writeln(f,'[meshbuilder]');
for i:=0 to 8 do
  begin
  if gleisa1[i,1,1]<>999 then
    begin
    writeln(f,'vertex ',gleisa1[i,1,1]:3:3,',0,',gleisa1[i,1,2]+p:3:3);
    writeln(f,'vertex ',gleisa1[i,2,1]:3:3,',0,',gleisa1[i,2,2]+p:3:3);
    end;
  end;

a:=0;
for i:=0 to 7 do
  begin
  if (gleisa1[i+1,1,1]<>999) and (i<>1) and (i<>3) and (i<>6) then
    writeln(f,'face ',a+2,',',a+3,',',a+1,',',a);
    a:=a+2;
  end;
writeln(f,'color 180,190,200');

writeln(f);

{Gleis A, rechts:}
writeln(f,'[meshbuilder]');
for i:=0 to 8 do
  begin
  if gleisa2[i,1,1]<>999 then
    begin
    writeln(f,'vertex ',gleisa2[i,1,1]:3:3,',0,',gleisa2[i,1,2]+p:3:3);
    writeln(f,'vertex ',gleisa2[i,2,1]:3:3,',0,',gleisa2[i,2,2]+p:3:3);
    end;
  end;

a:=0;
for i:=0 to 7 do
  begin
  if (gleisa2[i+1,1,1]<>999) and (i<>1) and (i<>4) and (i<>6) then
    writeln(f,'face ',a+2,',',a+3,',',a+1,',',a);
    a:=a+2;
  end;
writeln(f,'color 180,190,200');

writeln(f);

{Gleis B, links:}
writeln(f,'[meshbuilder]');
for i:=0 to 8 do
  begin
  if gleisb1[i,1,1]<>999 then
    begin
    writeln(f,'vertex ',gleisb1[i,1,1]:3:3,',0,',gleisb1[i,1,2]+p:3:3);
    writeln(f,'vertex ',gleisb1[i,2,1]:3:3,',0,',gleisb1[i,2,2]+p:3:3);
    end;
  end;

a:=0;
for i:=0 to 7 do
  begin
  if (gleisb1[i+1,1,1]<>999) and (i<>1) and (i<>4) and (i<>6) then
    writeln(f,'face ',a+2,',',a+3,',',a+1,',',a);
    a:=a+2;
  end;
writeln(f,'color 180,190,200');

writeln(f);

{Gleis B, rechts:}
writeln(f,'[meshbuilder]');
for i:=0 to 8 do
  begin
  if gleisb2[i,1,1]<>999 then
    begin
    writeln(f,'vertex ',gleisb2[i,1,1]:3:3,',0,',gleisb2[i,1,2]+p:3:3);
    writeln(f,'vertex ',gleisb2[i,2,1]:3:3,',0,',gleisb2[i,2,2]+p:3:3);
    end;
  end;

a:=0;
for i:=0 to 7 do
  begin
  if (gleisb2[i+1,1,1]<>999) and (i<>1) and (i<>3) and (i<>6) then
    writeln(f,'face ',a+2,',',a+3,',',a+1,',',a);
    a:=a+2;
  end;
writeln(f,'color 180,190,200');

writeln(f);

writeln(f,'[meshbuilder]');
for i:=1 to 8 do
writeln(f,'vertex ',fluegelsch[i,1]:3:3,',0,',fluegelsch[i,2]+p:3:3);
writeln(f,'face 0,1,2,3');

writeln(f,'face 4,5,6,7');

writeln(f,'color 85,50,50');

writeln(f,'[meshbuilder]');
for i:=9 to 16 do
writeln(f,'vertex ',fluegelsch[i,1]:3:3,',0,',fluegelsch[i,2]+p:3:3);
writeln(f,'face 0,1,2,3');

writeln(f,'face 4,5,6,7');

writeln(f,'color 85,50,50');

{Radlenker Mitte}
writeln(f,'[meshbuilder]');
for i:=1 to 5 do
  begin
  writeln(f,'vertex ',radlenk1[i,1,1]:3:3,',-0.01,',radlenk1[i,1,2]+p:3:3);
  writeln(f,'vertex ',radlenk1[i,2,1]:3:3,',-0.01,',radlenk1[i,2,2]+p:3:3);
  end;

a:=0;
for i:=0 to 3 do
  begin
  writeln(f,'face ',a,',',a+1,',',a+3,',',a+2);
  a:=a+2;
  end;
writeln(f,'color 85,50,50');

writeln(f);

writeln(f,'[meshbuilder]');
for i:=1 to 5 do
  begin
  writeln(f,'vertex ',radlenk2[i,1,1]:3:3,',-0.01,',radlenk2[i,1,2]+p:3:3);
  writeln(f,'vertex ',radlenk2[i,2,1]:3:3,',-0.01,',radlenk2[i,2,2]+p:3:3);
  end;

a:=0;
for i:=0 to 3 do
  begin
  writeln(f,'face ',a+2,',',a+3,',',a+1,',',a);
  a:=a+2;
  end;
writeln(f,'color 85,50,50');

writeln(f);

if radlenk<>'n' then
begin

{Radlenker hinten rechts}
writeln(f,'[meshbuilder]');
for i:=1 to 4 do
  begin
  writeln(f,'vertex ',radlenk3[i,1,1]:3:3,',0,',radlenk3[i,1,2]+p:3:3);
  writeln(f,'vertex ',radlenk3[i,2,1]:3:3,',0,',radlenk3[i,2,2]+p:3:3);
  end;

a:=0;
for i:=0 to 2 do
  begin
  writeln(f,'face ',a,',',a+1,',',a+3,',',a+2);
  a:=a+2;
  end;
writeln(f,'color 85,50,50');

writeln(f);

{Radlenker hinten links}
writeln(f,'[meshbuilder]');
for i:=1 to 4 do
  begin
  writeln(f,'vertex ',radlenk4[i,1,1]:3:3,',0,',radlenk4[i,1,2]+p:3:3);
  writeln(f,'vertex ',radlenk4[i,2,1]:3:3,',0,',radlenk4[i,2,2]+p:3:3);
  end;

a:=0;
for i:=0 to 2 do
  begin
  writeln(f,'face ',a,',',a+1,',',a+3,',',a+2);
  a:=a+2;
  end;
writeln(f,'color 85,50,50');

writeln(f);

{Radlenker vorne links}
writeln(f,'[meshbuilder]');
for i:=1 to 4 do
  begin
  writeln(f,'vertex ',radlenk5[i,1,1]:3:3,',0,',radlenk5[i,1,2]+p:3:3);
  writeln(f,'vertex ',radlenk5[i,2,1]:3:3,',0,',radlenk5[i,2,2]+p:3:3);
  end;

a:=0;
for i:=0 to 2 do
  begin
  writeln(f,'face ',a,',',a+1,',',a+3,',',a+2);
  a:=a+2;
  end;
writeln(f,'color 85,50,50');

writeln(f);

{Radlenker vorne rechts}
writeln(f,'[meshbuilder]');
for i:=1 to 4 do
  begin
  writeln(f,'vertex ',radlenk6[i,1,1]:3:3,',0,',radlenk6[i,1,2]+p:3:3);
  writeln(f,'vertex ',radlenk6[i,2,1]:3:3,',0,',radlenk6[i,2,2]+p:3:3);
  end;

a:=0;
for i:=0 to 2 do
  begin
  writeln(f,'face ',a,',',a+1,',',a+3,',',a+2);
  a:=a+2;
  end;
writeln(f,'color 85,50,50');

writeln(f);

end;


{Abzweigendes Gleis}

writeln(f,'[meshbuilder]');
for i:=0 to 5 do
  begin
  writeln(f,'vertex ',gleisr2[i,1]:3:3,', 0, ',gleisr2[i,2]+p:3:3);
  writeln(f,'vertex ',gleisr1[i,1]:3:3,', 0, ',gleisr1[i,2]+p:3:3);
  end;
zaehl:=0;
for i:=0 to 4 do
  begin
  writeln(f,'face ',zaehl+2,', ',zaehl+3,', ',zaehl+1,', ',zaehl);
  zaehl:=zaehl+2;
  end;
writeln(f,'color 180,190,200');
writeln(f);

writeln(f,'[meshbuilder]');
for i:=0 to 5 do
  begin
  writeln(f,'vertex ',gleisr4[i,1]:3:3,', 0, ',gleisr4[i,2]+p:3:3);
  writeln(f,'vertex ',gleisr3[i,1]:3:3,', 0, ',gleisr3[i,2]+p:3:3);
  end;
zaehl:=0;
for i:=0 to 4 do
  begin
  writeln(f,'face ',zaehl+2,', ',zaehl+3,', ',zaehl+1,', ',zaehl);
  zaehl:=zaehl+2;
  end;
writeln(f,'color 180,190,200');
writeln(f);

{EinmÅndendes Gleis}

writeln(f,'[meshbuilder]');
for i:=0 to 5 do
  begin
  writeln(f,'vertex ',gleisl2[i,1]:3:3,', 0, ',gleisl2[i,2]+p:3:3);
  writeln(f,'vertex ',gleisl1[i,1]:3:3,', 0, ',gleisl1[i,2]+p:3:3);
  end;
zaehl:=0;
for i:=0 to 4 do
  begin
  writeln(f,'face ',zaehl+2,', ',zaehl+3,', ',zaehl+1,', ',zaehl);
  zaehl:=zaehl+2;
  end;
writeln(f,'color 180,190,200');
writeln(f);

writeln(f,'[meshbuilder]');
for i:=0 to 5 do
  begin
  writeln(f,'vertex ',gleisl4[i,1]:3:3,', 0, ',gleisl4[i,2]+p:3:3);
  writeln(f,'vertex ',gleisl3[i,1]:3:3,', 0, ',gleisl3[i,2]+p:3:3);
  end;
zaehl:=0;
for i:=0 to 4 do
  begin
  writeln(f,'face ',zaehl+2,', ',zaehl+3,', ',zaehl+1,', ',zaehl);
  zaehl:=zaehl+2;
  end;
writeln(f,'color 180,190,200');
writeln(f);








{3D-Schienen:}
{Gleis A, links:}
writeln(f,'[meshbuilder]');
for i:=0 to 8 do
  begin
  if gleisa1[i,1,1]<>999 then
    begin
    if (i=2) or (i=4) or (i=6) then
      begin
      writeln(f,'vertex ',gleisa1[i,2,1]-0.04:3:3,',0,',gleisa1[i,2,2]+p:3:3);
      writeln(f,'vertex ',gleisa1[i,2,1]-0.04:3:3,',-0.17,',gleisa1[i,2,2]+p:3:3);
      end
    else
      begin
      writeln(f,'vertex ',gleisa1[i,1,1]+0.04:3:3,',0,',gleisa1[i,1,2]+p:3:3);
      writeln(f,'vertex ',gleisa1[i,1,1]+0.04:3:3,',-0.17,',gleisa1[i,1,2]+p:3:3);
      end;
    end;
  end;
a:=0;
for i:=0 to 7 do
  begin
  if (gleisa1[i+1,1,1]<>999) and (i<>1) and (i<>3) and (i<>6) then
    begin
      writeln(f,'face ',a+2,',',a+3,',',a+1,',',a);
      writeln(f,'face ',a,',',a+1,',',a+3,',',a+2);
    end;
    a:=a+2;
  end;
writeln(f,'color 85,50,50');
writeln(f);



{Gleis A, rechts:}
writeln(f,'[meshbuilder]');
for i:=0 to 8 do
  begin
  if gleisa2[i,1,1]<>999 then
    begin
    if (i=4) or (i=5) or (i=7) then
      begin
      writeln(f,'vertex ',gleisa2[i,2,1]-0.04:3:3,',0,',gleisa2[i,2,2]+p:3:3);
      writeln(f,'vertex ',gleisa2[i,2,1]-0.04:3:3,',-0.17,',gleisa2[i,2,2]+p:3:3);
      end
    else
    begin
      writeln(f,'vertex ',gleisa2[i,1,1]+0.04:3:3,',0,',gleisa2[i,1,2]+p:3:3);
      writeln(f,'vertex ',gleisa2[i,1,1]+0.04:3:3,',-0.17,',gleisa2[i,1,2]+p:3:3);
      end;
    end;
  end;

a:=0;
for i:=0 to 7 do
  begin
  if (gleisa2[i+1,1,1]<>999) and (i<>1) and (i<>4) and (i<>6) then
    begin
      writeln(f,'face ',a+2,',',a+3,',',a+1,',',a);
      writeln(f,'face ',a,',',a+1,',',a+3,',',a+2);
    end;
    a:=a+2;
  end;
writeln(f,'color 85,50,50');
writeln(f);



{Gleis B, links:}
writeln(f,'[meshbuilder]');
for i:=0 to 8 do
  begin
  if gleisb1[i,1,1]<>999 then
    begin
    if (i=2) or (i=4) or (i=6) then
      begin
      writeln(f,'vertex ',gleisb1[i,2,1]-0.04:3:3,',0,',gleisb1[i,2,2]+p:3:3);
      writeln(f,'vertex ',gleisb1[i,2,1]-0.04:3:3,',-0.17,',gleisb1[i,2,2]+p:3:3);
      end
    else
      begin
      writeln(f,'vertex ',gleisb1[i,1,1]+0.04:3:3,',0,',gleisb1[i,1,2]+p:3:3);
      writeln(f,'vertex ',gleisb1[i,1,1]+0.04:3:3,',-0.17,',gleisb1[i,1,2]+p:3:3);
      end;
    end;
  end;

a:=0;
for i:=0 to 7 do
  begin
  if (gleisb1[i+1,1,1]<>999) and (i<>1) and (i<>4) and (i<>6) then
    begin
      writeln(f,'face ',a+2,',',a+3,',',a+1,',',a);
      writeln(f,'face ',a,',',a+1,',',a+3,',',a+2);
      end;
    a:=a+2;
  end;
writeln(f,'color 85,50,50');
writeln(f);



{Gleis B, rechts:}
writeln(f,'[meshbuilder]');
for i:=0 to 8 do
  begin
  if gleisb2[i,1,1]<>999 then
    begin
    if (i=1) or (i=3) then
      begin
      writeln(f,'vertex ',gleisb2[i,2,1]-0.04:3:3,',0,',gleisb2[i,2,2]+p:3:3);
      writeln(f,'vertex ',gleisb2[i,2,1]-0.04:3:3,',-0.17,',gleisb2[i,2,2]+p:3:3);
      end
    else
      begin
      writeln(f,'vertex ',gleisb2[i,1,1]+0.04:3:3,',0,',gleisb2[i,1,2]+p:3:3);
      writeln(f,'vertex ',gleisb2[i,1,1]+0.04:3:3,',-0.17,',gleisb2[i,1,2]+p:3:3);
      end;
    end;
  end;

a:=0;
for i:=0 to 7 do
  begin
  if (gleisb2[i+1,1,1]<>999) and (i<>1) and (i<>3) and (i<>6) then
    begin
      writeln(f,'face ',a+2,',',a+3,',',a+1,',',a);
      writeln(f,'face ',a,',',a+1,',',a+3,',',a+2);
    end;
    a:=a+2;
  end;
writeln(f,'color 85,50,50');
writeln(f);


{3D-FlÅgelschienen}
writeln(f,'[meshbuilder]');
writeln(f,'vertex ',fluegelsch[1,1]+0.04:3:3,',0,',fluegelsch[1,2]+p:3:3);
writeln(f,'vertex ',fluegelsch[1,1]+0.04:3:3,',-0.17,',fluegelsch[1,2]+p:3:3);
writeln(f,'vertex ',fluegelsch[4,1]+0.04:3:3,',0,',fluegelsch[4,2]+p:3:3);
writeln(f,'vertex ',fluegelsch[4,1]+0.04:3:3,',-0.17,',fluegelsch[4,2]+p:3:3);

writeln(f,'vertex ',fluegelsch[6,1]-0.04:3:3,',0,',fluegelsch[6,2]+p:3:3);
writeln(f,'vertex ',fluegelsch[6,1]-0.04:3:3,',-0.17,',fluegelsch[6,2]+p:3:3);
writeln(f,'vertex ',fluegelsch[7,1]-0.04:3:3,',0,',fluegelsch[7,2]+p:3:3);
writeln(f,'vertex ',fluegelsch[7,1]-0.04:3:3,',-0.17,',fluegelsch[7,2]+p:3:3);

writeln(f,'vertex ',fluegelsch[9,1]-0.04:3:3,',0,',fluegelsch[9,2]+p:3:3);
writeln(f,'vertex ',fluegelsch[9,1]-0.04:3:3,',-0.17,',fluegelsch[9,2]+p:3:3);
writeln(f,'vertex ',fluegelsch[12,1]-0.04:3:3,',0,',fluegelsch[12,2]+p:3:3);
writeln(f,'vertex ',fluegelsch[12,1]-0.04:3:3,',-0.17,',fluegelsch[12,2]+p:3:3);

writeln(f,'vertex ',fluegelsch[14,1]+0.04:3:3,',0,',fluegelsch[14,2]+p:3:3);
writeln(f,'vertex ',fluegelsch[14,1]+0.04:3:3,',-0.17,',fluegelsch[14,2]+p:3:3);
writeln(f,'vertex ',fluegelsch[15,1]+0.04:3:3,',0,',fluegelsch[15,2]+p:3:3);
writeln(f,'vertex ',fluegelsch[15,1]+0.04:3:3,',-0.17,',fluegelsch[15,2]+p:3:3);

writeln(f,'face 0,2,3,1');
writeln(f,'face 1,3,2,0');
writeln(f,'face 4,6,7,5');
writeln(f,'face 5,7,6,4');
writeln(f,'face 8,10,11,9');
writeln(f,'face 9,11,10,8');
writeln(f,'face 12,14,15,13');
writeln(f,'face 13,15,14,12');
writeln(f,'color 85,50,50');

{3D-Schienen, abzweigendes Gleis rechts:}
writeln(f,'[meshbuilder]');
for i:=0 to 5 do
  begin
    writeln(f,'vertex ',gleisr1[i,1]-0.04:3:3,',0,',gleisr1[i,2]+p:3:3);
    writeln(f,'vertex ',gleisr1[i,1]-0.04:3:3,',-0.17,',gleisr1[i,2]+p:3:3);
  end;
a:=0;
for i:=1 to 5 do
begin
  writeln(f,'face ',a+2,',',a+3,',',a+1,',',a);
  writeln(f,'face ',a,',',a+1,',',a+3,',',a+2);
  a:=a+2;
  end;
writeln(f,'color 85,50,50');
writeln(f);

{3D-Schienen, abzweigendes Gleis links:}
writeln(f,'[meshbuilder]');
for i:=0 to 5 do
  begin
    writeln(f,'vertex ',gleisr3[i,1]-0.04:3:3,',0,',gleisr3[i,2]+p:3:3);
    writeln(f,'vertex ',gleisr3[i,1]-0.04:3:3,',-0.17,',gleisr3[i,2]+p:3:3);
  end;
a:=0;
for i:=1 to 5 do
begin
  writeln(f,'face ',a+2,',',a+3,',',a+1,',',a);
  writeln(f,'face ',a,',',a+1,',',a+3,',',a+2);
  a:=a+2;
  end;
writeln(f,'color 85,50,50');
writeln(f);

{3D-Schienen, einmÅndendes Gleis links:}
writeln(f,'[meshbuilder]');
for i:=0 to 5 do
  begin
    writeln(f,'vertex ',gleisl4[i,1]+0.04:3:3,',0,',gleisl4[i,2]+p:3:3);
    writeln(f,'vertex ',gleisl4[i,1]+0.04:3:3,',-0.17,',gleisl4[i,2]+p:3:3);
  end;
a:=0;
for i:=1 to 5 do
begin
  writeln(f,'face ',a+2,',',a+3,',',a+1,',',a);
  writeln(f,'face ',a,',',a+1,',',a+3,',',a+2);
  a:=a+2;
  end;
writeln(f,'color 85,50,50');
writeln(f);

{3D-Schienen, einmÅndendes Gleis rechts:}
writeln(f,'[meshbuilder]');
for i:=0 to 5 do
  begin
    writeln(f,'vertex ',gleisl2[i,1]+0.04:3:3,',0,',gleisl2[i,2]+p:3:3);
    writeln(f,'vertex ',gleisl2[i,1]+0.04:3:3,',-0.17,',gleisl2[i,2]+p:3:3);
  end;
a:=0;
for i:=1 to 5 do
begin
  writeln(f,'face ',a+2,',',a+3,',',a+1,',',a);
  writeln(f,'face ',a,',',a+1,',',a+3,',',a+2);
  a:=a+2;
  end;
writeln(f,'color 85,50,50');
writeln(f);

{3D-Radlenker Mitte}
writeln(f,'[meshbuilder]');
for i:=1 to 5 do
  begin
  writeln(f,'vertex ',radlenk1[i,1,1]:3:3,',-0.01,',radlenk1[i,1,2]+p:3:3);
  writeln(f,'vertex ',radlenk1[i,1,1]:3:3,',-0.17,',radlenk1[i,1,2]+p:3:3);
  end;

a:=0;
for i:=0 to 3 do
  begin
  writeln(f,'face ',a,',',a+1,',',a+3,',',a+2);
  writeln(f,'face ',a+2,',',a+3,',',a+1,',',a);
  a:=a+2;
  end;
writeln(f,'color 85,50,50');

writeln(f);

writeln(f,'[meshbuilder]');
for i:=1 to 5 do
  begin
  writeln(f,'vertex ',radlenk2[i,1,1]:3:3,',-0.01,',radlenk2[i,1,2]+p:3:3);
  writeln(f,'vertex ',radlenk2[i,1,1]:3:3,',-0.17,',radlenk2[i,1,2]+p:3:3);
  end;

a:=0;
for i:=0 to 3 do
  begin
  writeln(f,'face ',a+2,',',a+3,',',a+1,',',a);
  writeln(f,'face ',a,',',a+1,',',a+3,',',a+2);
  a:=a+2;
  end;
writeln(f,'color 85,50,50');

writeln(f);

if radlenk<>'n' then
begin

{3D-Radlenker hinten rechts}
writeln(f,'[meshbuilder]');
for i:=1 to 4 do
  begin
  writeln(f,'vertex ',radlenk3[i,2,1]:3:3,',0,',radlenk3[i,2,2]+p:3:3);
  writeln(f,'vertex ',radlenk3[i,2,1]:3:3,',-0.17,',radlenk3[i,2,2]+p:3:3);
  end;

a:=0;
for i:=0 to 2 do
  begin
  writeln(f,'face ',a,',',a+1,',',a+3,',',a+2);
  writeln(f,'face ',a+2,',',a+3,',',a+1,',',a);
  a:=a+2;
  end;
writeln(f,'color 85,50,50');

writeln(f);

{3D-Radlenker hinten links}
writeln(f,'[meshbuilder]');
for i:=1 to 4 do
  begin
  writeln(f,'vertex ',radlenk4[i,1,1]:3:3,',0,',radlenk4[i,1,2]+p:3:3);
  writeln(f,'vertex ',radlenk4[i,1,1]:3:3,',-0.17,',radlenk4[i,1,2]+p:3:3);
  end;

a:=0;
for i:=0 to 2 do
  begin
  writeln(f,'face ',a,',',a+1,',',a+3,',',a+2);
  writeln(f,'face ',a+2,',',a+3,',',a+1,',',a);
  a:=a+2;
  end;
writeln(f,'color 85,50,50');

writeln(f);

{3D-Radlenker vorne links}
writeln(f,'[meshbuilder]');
for i:=1 to 4 do
  begin
  writeln(f,'vertex ',radlenk5[i,2,1]:3:3,',0,',radlenk5[i,2,2]+p:3:3);
  writeln(f,'vertex ',radlenk5[i,2,1]:3:3,',-0.17,',radlenk5[i,2,2]+p:3:3);
  end;

a:=0;
for i:=0 to 2 do
  begin
  writeln(f,'face ',a,',',a+1,',',a+3,',',a+2);
  writeln(f,'face ',a+2,',',a+3,',',a+1,',',a);
  a:=a+2;
  end;
writeln(f,'color 85,50,50');

writeln(f);

{3D-Radlenker vorne rechts}
writeln(f,'[meshbuilder]');
for i:=1 to 4 do
  begin
  writeln(f,'vertex ',radlenk6[i,1,1]:3:3,',0,',radlenk6[i,1,2]+p:3:3);
  writeln(f,'vertex ',radlenk6[i,1,1]:3:3,',-0.17,',radlenk6[i,1,2]+p:3:3);
  end;

a:=0;
for i:=0 to 2 do
  begin
  writeln(f,'face ',a,',',a+1,',',a+3,',',a+2);
  writeln(f,'face ',a+2,',',a+3,',',a+1,',',a);
  a:=a+2;
  end;
writeln(f,'color 85,50,50');

writeln(f);

end;

                                        


end;
procedure gleisbett2;
var i: integer;
begin

{Schwellen rechts:}
writeln(f,'[meshbuilder]');
for i:=1 to 8 do
  begin
  writeln(f,'vertex ',schw1[i,1,1]:3:3,',-0.17,',schw1[i,1,2]+p:3:3);
  writeln(f,'vertex ',schw1[i,2,1]:3:3,',-0.17,',schw1[i,2,2]+p:3:3);
  end;

a:=0;
for i:=0 to 6 do
  begin
    writeln(f,'face ',a,',',a+1,',',a+3,',',a+2);
    a:=a+2;
  end;
writeln(f,'[texture]');
writeln(f,'load weiche1b.bmp');
a:=0;
b:=round(laenge/2.5);
for i:=0 to 7 do
  begin
  writeln(f,'coordinates ',a,',1.005,',b-schw1[i+1,1,2]/2.5:3:3);
  writeln(f,'coordinates ',a+1,',',0.995-((schw1[i+1,1,1]-schw1[i+1,2,1])/5.4):3:3,',',b-schw1[i+1,1,2]/2.5:3:3);
  a:=a+2;
  end;

writeln(f);

{Schwellen links:}
writeln(f,'[meshbuilder]');
for i:=1 to 8 do
  begin
  writeln(f,'vertex ',schw2[i,1,1]:3:3,',-0.17,',schw2[i,1,2]+p:3:3);
  writeln(f,'vertex ',schw2[i,2,1]:3:3,',-0.17,',schw2[i,2,2]+p:3:3);
  end;

a:=0;
for i:=0 to 6 do
  begin
    writeln(f,'face ',a+2,',',a+3,',',a+1,',',a);
    a:=a+2;
  end;
writeln(f,'[texture]');
writeln(f,'load weiche1b.bmp');
a:=0;
b:=round(laenge/2.5);
for i:=0 to 7 do
  begin
  writeln(f,'coordinates ',a,',1.005,',b-schw1[i+1,1,2]/2.5:3:3);
  writeln(f,'coordinates ',a+1,',',0.995-((schw1[i+1,1,1]-schw1[i+1,2,1])/5.4):3:3,',',b-schw1[i+1,1,2]/2.5:3:3);
  a:=a+2;
  end;

writeln(f);

{Schotterbett rechts}
writeln(f,'[meshbuilder]');
for i:=1 to 8 do
  begin
  writeln(f,'vertex ',schw1[i,1,1]:3:3,', -0.17, ',schw1[i,1,2]+p:3:3);
  writeln(f,'vertex ',schottr[i,1]:3:3,', -0.4, ',schottr[i,2]+p:3:3);
  end;
a:=0;

for i:=0 to 6 do
  begin
  writeln(f,'face ',a+1,',',a,',',a+2,',',a+3);
  a:=a+2;
  end;
writeln(f,'[texture]');
writeln(f,'load schotter1.bmp');
a:=0;
j:=0;
b:=round(laenge/2.5);
for i:=0 to 7 do
  begin
  writeln(f,'coordinates ',a,',',b-schw1[i+1,1,2]/2.5:3:3,',0');
  a:=a+1;
  writeln(f,'coordinates ',a,',',b-schw1[i+1,1,2]/2.5:3:3,',1');
  j:=j+2;
  a:=a+1;
  end;
writeln(f);

{Schotterbett links}
writeln(f,'[meshbuilder]');
for i:=1 to 8 do
  begin
  writeln(f,'vertex ',schw2[i,1,1]:3:3,', -0.17, ',schw2[i,1,2]+p:3:3);
  writeln(f,'vertex ',schottl[i,1]:3:3,', -0.4, ',schottl[i,2]+p:3:3);
  end;
a:=0;

for i:=0 to 6 do
  begin
  writeln(f,'face ',a+3,',',a+2,',',a,',',a+1);
  a:=a+2;
  end;
writeln(f,'[texture]');
writeln(f,'load schotter1.bmp');
a:=0;
j:=0;
b:=round(laenge/2.5);
for i:=0 to 7 do
  begin
  writeln(f,'coordinates ',a,',',b-schw1[i+1,1,2]/2.5:3:3,',0');
  a:=a+1;
  writeln(f,'coordinates ',a,',',b-schw1[i+1,1,2]/2.5:3:3,',1');
  j:=j+2;
  a:=a+1;
  end;
writeln(f);

{Oberleitung}
if (oberjn='j')or (oberjn='y') then
  begin

  if sprech='d' then
  writeln(f,';Oberleitung:')
  else
  writeln(f,';Overhead line:');

  for i:=0 to round(laenge/5) do
    oberaufh[i]:=(2*xoff/laenge)*i*5-xoff;

  writeln(f);
  writeln(f,'[meshbuilder]');
  writeln(f,'vertex ',-xoff-0.02:3:3,', ', oberfahr:3:3, ', ',p:3:3);
  writeln(f, 'vertex ',-xoff+0.02:3:3,', ', oberfahr:3:3, ', ',p:3:3);
  writeln(f, 'vertex ',xoff+0.02:3:3, ', ', oberfahr:3:3, ', ', round(laenge)+p:3:3);
  writeln(f, 'vertex ',xoff-0.02:3:3, ', ', oberfahr:3:3, ', ', round(laenge)+p:3:3);
  writeln(f,'face 0,1,2,3');
  writeln(f,'color 0,0,0');
  writeln(f);
  writeln(f,'[meshbuilder]');
  writeln(f,'vertex ',-xoff-0.01:3:3,', ', obertrag:3:3, ', ',p:3:3);
  writeln(f, 'vertex ',-xoff+0.01:3:3,', ', obertrag:3:3, ', ',p:3:3);
  writeln(f, 'vertex ',xoff+0.01:3:3, ', ', obertrag:3:3, ', ', round(laenge)+p:3:3);
  writeln(f, 'vertex ',xoff-0.01:3:3, ', ', obertrag:3:3, ', ', round(laenge)+p:3:3);
  writeln(f,'face 0,1,2,3');
  writeln(f,'color 0,0,0');
  writeln(f);

  for i:=0 to round(laenge/5) do
    begin
    writeln(f,'[meshbuilder]');
    writeln(f, 'vertex ',oberaufh[i]-0.01:3:3, ', ', obertrag:3:3, ', ', i*5+p:3:3);
    writeln(f, 'vertex ',oberaufh[i]+0.01:3:3, ', ', obertrag:3:3, ', ', i*5+p:3:3);
    writeln(f, 'vertex ',oberaufh[i]+0.01:3:3, ', ', oberfahr:3:3, ', ', i*5+p:3:3);
    writeln(f, 'vertex ',oberaufh[i]-0.01:3:3, ', ', oberfahr:3:3, ', ', i*5+p:3:3);
    writeln(f, 'face 0,1,2,3');
    writeln(f,'color 0,0,0');
    end;

    writeln(f);
  writeln(f,'[meshbuilder]');
  writeln(f,'vertex ',-0.02:3:3,', ', oberfahr:3:3, ', ',p:3:3);
  writeln(f, 'vertex ',0.02:3:3,', ', oberfahr:3:3, ', ',p:3:3);
  writeln(f, 'vertex ',0.02:3:3, ', ', oberfahr:3:3, ', ', round(laenge)+p:3:3);
  writeln(f, 'vertex ',-0.02:3:3, ', ', oberfahr:3:3, ', ', round(laenge)+p:3:3);
  writeln(f,'face 0,1,2,3');
  writeln(f,'color 0,0,0');
  writeln(f);
  writeln(f,'[meshbuilder]');
  writeln(f,'vertex ',-0.01:3:3,', ', obertrag:3:3, ', ',p:3:3);
  writeln(f, 'vertex ',0.01:3:3,', ', obertrag:3:3, ', ',p:3:3);
  writeln(f, 'vertex ',0.01:3:3, ', ', obertrag:3:3, ', ', round(laenge)+p:3:3);
  writeln(f, 'vertex ',-0.01:3:3, ', ', obertrag:3:3, ', ', round(laenge)+p:3:3);
  writeln(f,'face 0,1,2,3');
  writeln(f,'color 0,0,0');
  writeln(f);

  for i:=0 to round(laenge/5) do
    oberaufh[i]:=0;

  for i:=0 to round(laenge/5) do
    begin
    writeln(f,'[meshbuilder]');
    writeln(f, 'vertex ',oberaufh[i]-0.01:3:3, ', ', obertrag:3:3, ', ', i*5+p:3:3);
    writeln(f, 'vertex ',oberaufh[i]+0.01:3:3, ', ', obertrag:3:3, ', ', i*5+p:3:3);
    writeln(f, 'vertex ',oberaufh[i]+0.01:3:3, ', ', oberfahr:3:3, ', ', i*5+p:3:3);
    writeln(f, 'vertex ',oberaufh[i]-0.01:3:3, ', ', oberfahr:3:3, ', ', i*5+p:3:3);
    writeln(f, 'face 0,1,2,3');
    writeln(f,'color 0,0,0');
    end;

end;
close(f);
end;



end.